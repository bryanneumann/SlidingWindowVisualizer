<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sliding Window Technique Visualizer</title>
    
    <!-- Bootstrap CSS with Replit dark theme -->
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container py-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <h1 class="display-4 mb-0">
                        <i class="bi bi-window-stack"></i>
                        <span data-translate="title">Sliding Window Technique Visualizer</span>
                    </h1>
                    <div class="d-flex gap-2">
                        <div class="btn-group" role="group" aria-label="Language selection">
                            <button type="button" class="btn btn-outline-secondary btn-sm" id="lang-en" onclick="switchLanguage('en')">EN</button>
                            <button type="button" class="btn btn-outline-secondary btn-sm active" id="lang-es" onclick="switchLanguage('es')">ES</button>
                        </div>
                        <a href="https://github.com/bryanneumann/SlidingWindowVisualizer" target="_blank" class="btn btn-outline-primary">
                            <i class="bi bi-github"></i>
                            <span data-translate="get-code">Get the Code</span>
                        </a>
                    </div>
                </div>
                <p class="lead" data-translate="description">
                    Learn and visualize sliding window techniques with interactive demonstrations for both fixed and variable size windows.
                </p>
            </div>
        </div>

        <!-- Technique Type Selection -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">
                            <i class="bi bi-gear"></i>
                            <span data-translate="configuration">Configuration</span>
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="windowType" class="form-label" data-translate="window-type">Window Type</label>
                                <select class="form-select" id="windowType">
                                    <option value="fixed" selected data-translate="fixed-window">Fixed Size Window</option>
                                    <option value="variable" data-translate="variable-window">Variable Size Window</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="algorithm" class="form-label" data-translate="technique">Technique</label>
                                <select class="form-select" id="algorithm">
                                    <option value="sum" selected data-translate="sum-elements">Sum of Elements</option>
                                    <option value="max" data-translate="max-element">Maximum Element</option>
                                    <option value="min" data-translate="min-element">Minimum Element</option>
                                    <option value="avg" data-translate="avg-elements">Average of Elements</option>
                                    <option value="longest_substring" data-translate="longest-substring">Longest Substring Without Repeating Characters</option>
                                    <option value="permutation_in_string" data-translate="permutation-string">Permutation in String</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-8 mb-3">
                                <label for="inputArray" class="form-label" id="inputLabel" data-translate="input-array">Input Array (comma-separated numbers)</label>
                                <input type="text" class="form-control" id="inputArray" data-translate-placeholder="input-placeholder" placeholder="1, 2, 3, 4, 5, 6, 7, 8" value="1, 2, 3, 4, 5, 6, 7, 8">
                            </div>
                            <div class="col-md-4 mb-3" id="windowSizeContainer">
                                <label for="windowSize" class="form-label" data-translate="window-size">Window Size</label>
                                <input type="number" class="form-control" id="windowSize" min="1" max="10" value="3">
                            </div>
                        </div>
                        
                        <div class="row" id="patternContainer" style="display: none;">
                            <div class="col-md-6 mb-3">
                                <label for="patternInput" class="form-label" data-translate="pattern-find">Pattern to Find</label>
                                <input type="text" class="form-control" id="patternInput" placeholder="ab" value="ab">
                            </div>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <button class="btn btn-primary" id="startVisualization">
                                <i class="bi bi-play-circle-fill"></i>
                                <span data-translate="start">Start</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visualization Area -->
        <div class="row mb-4" id="visualizationSection" style="display: none;">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">
                            <i class="bi bi-eye"></i>
                            <span data-translate="visualization">Visualization</span>
                        </h5>
                        <div class="d-flex gap-2 align-items-center">
                            <button class="btn btn-outline-primary btn-sm" id="showCodeBtn">
                                <i class="bi bi-code-slash"></i>
                                <span data-translate="show-code">Show Code</span>
                            </button>
                            <label for="speedControl" class="form-label mb-0 me-2" data-translate="speed">Speed:</label>
                            <input type="range" class="form-range" id="speedControl" min="1" max="5" value="3" style="width: 100px;">
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- Array Visualization -->
                        <div class="mb-4">
                            <h6 data-translate="array-elements">Array Elements:</h6>
                            <div id="arrayVisualization" class="d-flex flex-wrap gap-2 mb-3" style="width: 100%; overflow-x: visible; overflow-y: visible; padding-bottom: 60px; min-height: 140px;"></div>
                        </div>
                        
                        <!-- Window Information -->
                        <div class="mb-4">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 data-translate="current-window">Current Window:</h6>
                                    <div id="currentWindow" class="alert alert-info"></div>
                                </div>
                                <div class="col-md-6">
                                    <h6 data-translate="calculation">Calculation:</h6>
                                    <div id="calculation" class="alert alert-success"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Results Summary -->
                        <div class="mt-4">
                            <h6 data-translate="analysis">Window Analysis Summary:</h6>
                            <div id="resultsSummary" class="table-responsive" style="display: none;">
                                <table class="table table-sm table-striped">
                                    <thead>
                                        <tr>
                                            <th data-translate="step">Step</th>
                                            <th data-translate="window-position">Window Position</th>
                                            <th data-translate="window-content">Window Content</th>
                                            <th data-translate="result">Result</th>
                                            <th data-translate="status">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="summaryTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        
                        <!-- Progress -->
                        <div class="mb-3">
                            <div class="d-flex justify-content-between mb-1">
                                <span>Progress</span>
                                <span id="progressText">Step 0 of 0</span>
                            </div>
                            <div class="progress">
                                <div class="progress-bar" id="progressBar" role="progressbar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Explanation Section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">
                            <i class="bi bi-book"></i>
                            <span data-translate="understanding-sliding-window">Understanding Sliding Window</span>
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6 data-translate="fixed-window-title">Fixed Size Window</h6>
                                <p class="text-muted" data-translate="fixed-window-desc">
                                    A fixed-size sliding window maintains a constant size as it moves through the data structure. 
                                    This is useful for problems like finding the maximum sum of a subarray of size k, or calculating 
                                    moving averages.
                                </p>
                                <h6 data-translate="common-applications">Common Applications:</h6>
                                <ul class="text-muted">
                                    <li data-translate="max-sum-subarray">Maximum sum subarray of size k</li>
                                    <li data-translate="moving-averages">Moving averages</li>
                                    <li data-translate="finding-anagrams">Finding anagrams in a string</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6 data-translate="variable-window-title">Variable Size Window</h6>
                                <p class="text-muted" data-translate="variable-window-desc">
                                    A variable-size sliding window can expand or contract based on certain conditions. 
                                    This technique is often used when you need to find the optimal subarray that satisfies 
                                    specific criteria.
                                </p>
                                <h6 data-translate="common-applications">Common Applications:</h6>
                                <ul class="text-muted">
                                    <li data-translate="longest-substring-k">Longest substring with k distinct characters</li>
                                    <li data-translate="min-window-substring">Minimum window substring</li>
                                    <li data-translate="subarray-given-sum">Subarray with given sum</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Code Generation Modal -->
        <div class="modal fade" id="codeModal" tabindex="-1" aria-labelledby="codeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="codeModalLabel">
                            <i class="bi bi-code-slash"></i>
                            Technique Implementation
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="codeLanguage" class="form-label">Programming Language</label>
                                <select class="form-select" id="codeLanguage">
                                    <option value="python" selected>Python</option>
                                    <option value="java">Java</option>
                                    <option value="javascript">JavaScript</option>
                                    <option value="cpp">C++</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <div class="d-flex gap-2 align-items-end h-100">
                                    <button class="btn btn-outline-secondary" id="copyCodeBtn" disabled>
                                        <i class="bi bi-clipboard"></i>
                                        Copy Code
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <h6>Algorithm Details:</h6>
                            <div id="algorithmInfo" class="alert alert-info">
                                Algorithm information will appear here when you open the code modal.
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <h6>Code Implementation:</h6>
                            <div class="code-container">
                                <pre><code id="generatedCode" class="language-python">// Code will be generated automatically when you select a language...</code></pre>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <h6>Time & Space Complexity:</h6>
                            <div id="complexityInfo" class="alert alert-secondary">
                                Complexity analysis will be shown after code generation.
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <a href="#" class="btn btn-outline-primary" id="downloadCodeBtn" disabled>
                            <i class="bi bi-download"></i>
                            Download Code
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Examples Section -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">
                            <i class="bi bi-collection"></i>
                            <span data-translate="example-problems">Example Problems</span>
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row" id="examplesContainer">
                            <!-- Examples will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Translation System -->
    <script>
        // Translation dictionary
        const translations = {
            en: {
                'title': 'Sliding Window Technique Visualizer',
                'get-code': 'Get the Code',
                'description': 'Learn and visualize sliding window techniques with interactive demonstrations for both fixed and variable size windows.',
                'configuration': 'Configuration',
                'window-type': 'Window Type',
                'fixed-window': 'Fixed Size Window',
                'variable-window': 'Variable Size Window',
                'technique': 'Technique',
                'sum-elements': 'Sum of Elements',
                'max-element': 'Maximum Element',
                'min-element': 'Minimum Element',
                'avg-elements': 'Average of Elements',
                'longest-substring': 'Longest Substring Without Repeating Characters',
                'permutation-string': 'Permutation in String',
                'input-array': 'Input Array (comma-separated numbers)',
                'input-placeholder': '1, 2, 3, 4, 5, 6, 7, 8',
                'window-size': 'Window Size',
                'start': 'Start',
                'visualization': 'Visualization',
                'play': 'Play',
                'pause': 'Pause',
                'step-forward': 'Step Forward',
                'step-backward': 'Step Backward',
                'reset': 'Reset',
                'speed': 'Speed',
                'slow': 'Slow',
                'normal': 'Normal',
                'fast': 'Fast',
                'analysis': 'Window Analysis Summary',
                'step': 'Step',
                'window': 'Window',
                'result': 'Result',
                'description-col': 'Description',
                'current-window': 'Current Window',
                'algorithm-info': 'Algorithm Information',
                'time-complexity': 'Time Complexity',
                'space-complexity': 'Space Complexity',
                'generate-code': 'Generate Code',
                'copy-code': 'Copy Code',
                'download': 'Download',
                'examples': 'Examples',
                'load-example': 'Load Example',
                'calculation': 'Calculation',
                'window-position': 'Window Position',
                'window-content': 'Window Content',
                'status': 'Status',
                'understanding-sliding-window': 'Understanding Sliding Window',
                'show-code': 'Show Code',
                'array-elements': 'Array Elements',
                'pattern-find': 'Pattern to Find',
                'fixed-window-title': 'Fixed Size Window',
                'variable-window-title': 'Variable Size Window',
                'fixed-window-desc': 'A fixed-size sliding window maintains a constant size as it moves through the data structure. This is useful for problems like finding the maximum sum of a subarray of size k, or calculating moving averages.',
                'variable-window-desc': 'A variable-size sliding window can expand or contract based on certain conditions. This technique is often used when you need to find the optimal subarray that satisfies specific criteria.',
                'common-applications': 'Common Applications:',
                'max-sum-subarray': 'Maximum sum subarray of size k',
                'moving-averages': 'Moving averages',
                'finding-anagrams': 'Finding anagrams in a string',
                'longest-substring-k': 'Longest substring with k distinct characters',
                'min-window-substring': 'Minimum window substring',
                'subarray-given-sum': 'Subarray with given sum',
                'example-problems': 'Example Problems',
                'example-max-sum-title': 'Maximum Sum Subarray',
                'example-max-sum-desc': 'Find the maximum sum of a subarray of size 3',
                'example-moving-avg-title': 'Moving Average',
                'example-moving-avg-desc': 'Calculate moving average with window size 4',
                'example-max-window-title': 'Maximum in Window',
                'example-max-window-desc': 'Find maximum element in each window of size 3',
                'example-expanding-title': 'Expanding Window Sum',
                'example-expanding-desc': 'Calculate cumulative sum with expanding window',
                'step-progress': 'Step',
                'of': 'of',
                'sum-of-window': 'Sum of window:',
                'max-in-window': 'Maximum in window:',
                'min-in-window': 'Minimum in window:',
                'avg-of-window': 'Average of window:'
            },
            es: {
                'title': 'Visualizador de Técnica de Ventana Deslizante',
                'get-code': 'Obtener el Código',
                'description': 'Aprende y visualiza técnicas de ventana deslizante con demostraciones interactivas para ventanas de tamaño fijo y variable.',
                'configuration': 'Configuración',
                'window-type': 'Tipo de Ventana',
                'fixed-window': 'Ventana de Tamaño Fijo',
                'variable-window': 'Ventana de Tamaño Variable',
                'technique': 'Técnica',
                'sum-elements': 'Suma de Elementos',
                'max-element': 'Elemento Máximo',
                'min-element': 'Elemento Mínimo',
                'avg-elements': 'Promedio de Elementos',
                'longest-substring': 'Subcadena Más Larga Sin Caracteres Repetidos',
                'permutation-string': 'Permutación en Cadena',
                'input-array': 'Arreglo de Entrada (números separados por comas)',
                'input-placeholder': '1, 2, 3, 4, 5, 6, 7, 8',
                'window-size': 'Tamaño de Ventana',
                'start': 'Iniciar',
                'visualization': 'Visualización',
                'play': 'Reproducir',
                'pause': 'Pausar',
                'step-forward': 'Paso Adelante',
                'step-backward': 'Paso Atrás',
                'reset': 'Reiniciar',
                'speed': 'Velocidad',
                'slow': 'Lento',
                'normal': 'Normal',
                'fast': 'Rápido',
                'analysis': 'Resumen de Análisis de Ventana',
                'step': 'Paso',
                'window': 'Ventana',
                'result': 'Resultado',
                'description-col': 'Descripción',
                'current-window': 'Ventana Actual',
                'algorithm-info': 'Información del Algoritmo',
                'time-complexity': 'Complejidad Temporal',
                'space-complexity': 'Complejidad Espacial',
                'generate-code': 'Generar Código',
                'copy-code': 'Copiar Código',
                'download': 'Descargar',
                'examples': 'Ejemplos',
                'load-example': 'Cargar Ejemplo',
                'calculation': 'Cálculo',
                'window-position': 'Posición de Ventana',
                'window-content': 'Contenido de Ventana',
                'status': 'Estado',
                'understanding-sliding-window': 'Entendiendo Ventana Deslizante',
                'show-code': 'Mostrar Código',
                'array-elements': 'Elementos del Arreglo',
                'pattern-find': 'Patrón a Encontrar',
                'fixed-window-title': 'Ventana de Tamaño Fijo',
                'variable-window-title': 'Ventana de Tamaño Variable',
                'fixed-window-desc': 'Una ventana deslizante de tamaño fijo mantiene un tamaño constante mientras se mueve a través de la estructura de datos. Esto es útil para problemas como encontrar la suma máxima de un subarreglo de tamaño k, o calcular promedios móviles.',
                'variable-window-desc': 'Una ventana deslizante de tamaño variable puede expandirse o contraerse según ciertas condiciones. Esta técnica se usa frecuentemente cuando necesitas encontrar el subarreglo óptimo que satisface criterios específicos.',
                'common-applications': 'Aplicaciones Comunes:',
                'max-sum-subarray': 'Suma máxima de subarreglo de tamaño k',
                'moving-averages': 'Promedios móviles',
                'finding-anagrams': 'Encontrar anagramas en una cadena',
                'longest-substring-k': 'Subcadena más larga con k caracteres distintos',
                'min-window-substring': 'Subcadena de ventana mínima',
                'subarray-given-sum': 'Subarreglo con suma dada',
                'example-problems': 'Problemas de Ejemplo',
                'example-max-sum-title': 'Suma Máxima de Subarreglo',
                'example-max-sum-desc': 'Encuentra la suma máxima de un subarreglo de tamaño 3',
                'example-moving-avg-title': 'Promedio Móvil',
                'example-moving-avg-desc': 'Calcula el promedio móvil con ventana de tamaño 4',
                'example-max-window-title': 'Máximo en Ventana',
                'example-max-window-desc': 'Encuentra el elemento máximo en cada ventana de tamaño 3',
                'example-expanding-title': 'Suma de Ventana Expansiva',
                'example-expanding-desc': 'Calcula la suma acumulativa con ventana expansiva',
                'step-progress': 'Paso',
                'of': 'de',
                'sum-of-window': 'Suma de ventana:',
                'max-in-window': 'Máximo en ventana:',
                'min-in-window': 'Mínimo en ventana:',
                'avg-of-window': 'Promedio de ventana:'
            }
        };

        // Detect browser language or default to English
        function detectBrowserLanguage() {
            const browserLang = navigator.language || navigator.userLanguage;
            // Check if browser language starts with 'es' (Spanish variants)
            if (browserLang.toLowerCase().startsWith('es')) {
                return 'es';
            }
            // Default to English for all other languages
            return 'en';
        }
        
        let currentLanguage = detectBrowserLanguage();
        window.currentLanguage = currentLanguage;
        window.translations = translations;

        // Language switching function
        function switchLanguage(lang) {
            currentLanguage = lang;
            window.currentLanguage = lang; // Make it globally accessible
            
            // Update button states
            document.getElementById('lang-en').classList.toggle('active', lang === 'en');
            document.getElementById('lang-es').classList.toggle('active', lang === 'es');
            
            // Update document lang attribute
            document.documentElement.lang = lang;
            
            // Translate all elements with data-translate attribute
            const elementsToTranslate = document.querySelectorAll('[data-translate]');
            elementsToTranslate.forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[lang] && translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });
            
            // Translate placeholders
            const placeholderElements = document.querySelectorAll('[data-translate-placeholder]');
            placeholderElements.forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (translations[lang] && translations[lang][key]) {
                    element.placeholder = translations[lang][key];
                }
            });
            
            // Update dynamic content if visualizer exists
            if (window.visualizer && window.visualizer.getTranslation) {
                // Refresh current visualization display if active
                const currentWindowEl = document.getElementById('currentWindow');
                const calculationEl = document.getElementById('calculation');
                
                if (currentWindowEl && currentWindowEl.innerHTML.trim()) {
                    // Re-render current window info with new language
                    window.visualizer.updateVisualization();
                }
                
                // Reload examples with new language
                window.visualizer.loadExamples();
            }
            
            // Store language preference
            localStorage.setItem('preferredLanguage', lang);
        }

        // Initialize language on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Check for stored language preference, otherwise use browser locale
            const storedLang = localStorage.getItem('preferredLanguage');
            const initialLanguage = storedLang || detectBrowserLanguage();
            switchLanguage(initialLanguage);
        });
    </script>
    
    <!-- Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/sliding_window.js') }}"></script>
</body>
</html>
